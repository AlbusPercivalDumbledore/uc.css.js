/* use scrollbars instead of scroll buttons on most arrowscrollboxes */
menupopup::part(arrowscrollbox-scrollbox) {
    overflow-y: auto !important;
    padding-top: 0 !important;
    margin-block: 0 !important;
    scroll-behavior: smooth !important;
}

/* style the scrollbox so it works without scroll buttons */
menupopup::part(arrowscrollbox) {
    padding-bottom: 0 !important;
}

menupopup[placespopup="true"]::part(innerbox) {
    border: none !important;
}

/* padding for proton context menus */
:is(#back-button, #forward-button, #viewButton) > menupopup::part(arrowscrollbox),
:is(.popup-notification-dropmarker, #main-menubar, #PlacesToolbar, #places) menupopup::part(arrowscrollbox),
:is(#toolbar-context-menu, #tabContextMenu, #contentAreaContextMenu, #backForwardMenu, #placesContext, #pageActionContextMenu, .search-one-offs-context-menu, #SyncedTabsSidebarContext, .textbox-contextmenu, #customizationPanelItemContextMenu, #customizationPaletteItemContextMenu, #customization-toolbar-menu, #new-tab-button-popup, #new-tab-button, #downloadsContextMenu, menupopup[menu-api], #ContentSelectDropdown, menupopup.in-menulist, .new-tab-popup, #openHandlerPopup)::part(arrowscrollbox),
:is(#back-button, #forward-button, #viewButton) > menupopup menupopup::part(arrowscrollbox),
:is(.popup-notification-dropmarker, #main-menubar, #PlacesToolbar, #places) menupopup menupopup::part(arrowscrollbox),
:is(#toolbar-context-menu, #tabContextMenu, #contentAreaContextMenu, #backForwardMenu, #placesContext, #pageActionContextMenu, .search-one-offs-context-menu, #SyncedTabsSidebarContext, .textbox-contextmenu, #customizationPanelItemContextMenu, #customizationPaletteItemContextMenu, #customization-toolbar-menu, #new-tab-button-popup, #new-tab-button, #downloadsContextMenu, menupopup[menu-api], #ContentSelectDropdown, menupopup.in-menulist, .new-tab-popup, #openHandlerPopup) menupopup::part(arrowscrollbox)
{
    padding: var(--menupopup-inner-padding) !important;
}

@-moz-document url-prefix("chrome://devtools/content/") {
    menupopup::part(arrowscrollbox) {
        padding: var(--menupopup-inner-padding) !important;
    }
}

#ContentSelectDropdown > menupopup::part(arrowscrollbox) {
    padding: var(--menupopup-inner-padding) !important;
}

/* hide scroll buttons â€” doesn't seem to work anymore. put this in your regular userChrome.css instead:
link[href="chrome://global/skin/arrowscrollbox.css"] ~ :is(#scrollbutton-up, #scrollbutton-down) {
        visibility: collapse;
} */
.menupopup-arrowscrollbox::part(scrollbutton-up),
.menupopup-arrowscrollbox::part(scrollbutton-down) {
    visibility: collapse;
}

/* hide tab bar's arrow buttons and spacers */
#tabbrowser-arrowscrollbox::part(scrollbutton-up),
#tabbrowser-arrowscrollbox::part(scrollbutton-down),
#tabbrowser-arrowscrollbox::part(overflow-start-indicator),
#tabbrowser-arrowscrollbox::part(overflow-end-indicator) {
    visibility: collapse;
}

/* when drag mode is enabled. this enables the tab shadows to draw onto the drag space. */
:root[sizemode="normal"] #TabsToolbar > .toolbar-items #tabbrowser-arrowscrollbox::part(scrollbox) {
    min-height: calc(var(--min-tab-height) + var(--space-above-tabbar));
    padding-block-start: var(--space-above-tabbar);
}

/* protections popup panel's arrow style */
#protections-popup[side="top"]::part(arrow) {
    /* stroke: hsl(216.5, 90%, 39.4%) !important; */
    stroke: none !important;
    width: 22px !important;
    height: 11.4px !important;
    margin-inline-start: 9.2px !important;
    margin-top: 0 !important;
}

#protections-popup[mainviewshowing][side="top"]::part(arrow) {
    fill: var(--protection-header-arrow-color);
}

/* other panel arrows */
:is(panel, menupopup)::part(arrow) {
    stroke: var(--arrowpanel-background);
}

@-moz-document url(chrome://browser/content/browser.xhtml)
{
    :is(panel, menupopup)::part(arrow) {
        display: -moz-inline-box;
    }
}

#identity-icon {
    list-style-image: var(--default-identity-icon);
}

/* dropmarkers and other select/menulist stuff */
@-moz-document url(chrome://browser/content/browser.xhtml)
{
    menulist:not([native]) {
        padding-inline: 6px;
    }

    panel menulist::part(dropmarker-icon) {
        appearance: none;
        list-style-image: url("chrome://devtools/skin/images/select-arrow.svg");
        margin-block: 0 !important;
    }

    panel menulist::part(dropmarker) {
        margin-inline-start: 6px;
    }

    panel menulist::part(dropmarker),
    panel menulist::part(icon) {
        -moz-context-properties: fill, fill-opacity;
    }

    panel menulist::part(label) {
        font-weight: normal;
    }

    menulist::part(label) {
        appearance: none;
        margin-block: 0;
    }

    #editBMPanel_folderMenuList::part(icon) {
        margin-inline: 3px;
    }
}

/* proton stuff */
.subviewbutton > menupopup::part(innerbox) {
    padding-block: 4px;
    border-radius: 5px;
}

/* prevent hiding the close button when audio is playing. undoes an irritating rule in the proton update */
#navigator-toolbox:not(:hover) .tab-icon-overlay:not([pinned], [sharing], [crashed]):is([soundplaying], [muted], [activemedia-blocked]),
#navigator-toolbox:hover .tab-icon-stack:not([pinned], [sharing], [crashed]):is([soundplaying], [muted], [activemedia-blocked]) > :not(.tab-icon-overlay) {
	opacity: revert;
}

#toolbar-menubar:not(:hover) + #TabsToolbar:not(:hover) .tab-icon-overlay:not([pinned], [sharing], [crashed]):is([soundplaying], [muted], [activemedia-blocked]),
:is(#toolbar-menubar:hover + #TabsToolbar, #TabsToolbar:hover) .tab-icon-stack:not([pinned], [sharing], [crashed]):is([soundplaying], [muted], [activemedia-blocked]) > :not(.tab-icon-overlay) {
	opacity: revert;
}
