.panel-arrowcontent {
    box-shadow: 0 0 4px rgba(0, 0, 0, 0.2) !important;
}

.panel-arrow {
    margin-top: 2px;
}

#customization-panelWrapper > .panel-arrowbox > .panel-arrow[side="top"] {
    stroke: var(--arrowpanel-background) !important;
}

.panel-footer > button:not([disabled]):is(:hover, :focus-visible) {
    background-color: var(
        --button-hover-bgcolor,
        color-mix(in srgb, currentColor 17%, transparent)
    );
}

.panel-footer > button:not([disabled]):is(:hover, :focus-visible):active {
    background-color: var(
        --button-active-bgcolor,
        color-mix(in srgb, currentColor 30%, transparent)
    );
}

.protections-popup-category,
.protections-popup-footer-button {
    border-radius: var(--toolbarbutton-border-radius) !important;
    margin-inline: calc(
        var(--horizontal-padding) - var(--arrowpanel-menuitem-inline-margin) - 5px
    ) !important;
}

.protections-popup-category {
    padding-inline: calc(var(--arrowpanel-menuitem-inline-margin) + 5px) !important;
}

.protections-popup-footer-button {
    padding-inline: calc(var(--arrowpanel-menuitem-inline-margin) + 1px) !important;
}

#protections-popup-footer-protection-type-label {
    margin-inline-end: 0 !important;
}

.protections-popup-category::after {
    content: url(chrome://global/skin/icons/menu-arrow.svg) !important;
    scale: none !important;
    translate: none !important;
    transform: translateX(2px) !important;
    display: -moz-inline-box;
}

.popup-notification-warning:empty,
.addon-webext-perm-list:empty {
    display: none !important;
}

.panel-footer.popup-notification-button-container {
    gap: var(--arrowpanel-padding) !important;
    margin-inline: var(--arrowpanel-padding) !important;
    margin-bottom: var(--arrowpanel-padding) !important;
    margin-top: calc(var(--arrowpanel-padding) / 4) !important;
}

.panel-footer.popup-notification-button-container > .popup-notification-button {
    margin-inline: 0 !important;
    border-radius: var(--toolbarbutton-border-radius) !important;
    flex: 1 !important;
    font-weight: normal !important;
    border-inline: 0 !important;
}

panel {
    --panel-separator-color: var(--desaturate-dimmed) !important;
}

.popup-notification-button-container > button:not([disabled]):is(:hover:active, [open]) {
    background-color: var(--arrowpanel-dimmed-even-further) !important;
}

.popup-notification-button-container > button:not([disabled]):hover {
    background-color: var(--arrowpanel-dimmed-further) !important;
}

.popup-notification-button-container > button {
    background-color: var(--arrowpanel-dimmed) !important;
}

.popup-notification-button-container > button[disabled] {
    background-color: var(--arrowpanel-dimmed) !important;
    opacity: 0.5;
}

.popup-notification-button-container > button[disabled] .button-text {
    color: white;
}

.popup-notification-primary-button {
    border-inline-end: 1px solid var(--panel-separator-color) !important;
}

.panel-footer > .popup-notification-primary-button:not([disabled]) {
    background-color: hsl(237, 26%, 30%) !important;
}

.panel-footer > .popup-notification-primary-button:not([disabled]):hover {
    background-color: hsl(242, 60%, 56%) !important;
}

.panel-footer > .popup-notification-primary-button:not([disabled]):hover:active {
    background-color: hsl(242, 65%, 60%) !important;
}

popupnotification .popup-notification-checkbox {
    margin-block: 4px !important;
}

popupnotification checkbox .checkbox-check {
    appearance: none !important;
    min-width: 10px !important;
    min-height: 10px !important;
    width: 13px;
    height: 13px;
    margin-inline-end: 4px !important;
    padding: 0.5px;
    border: 1px solid var(--in-content-box-border-color) !important;
    border-radius: 2px;
    margin: 0;
    background-color: var(--arrowpanel-dimmed) !important;
    background-position: center;
    background-repeat: no-repeat;
}

popupnotification checkbox .checkbox-check[checked] {
    list-style-image: url("chrome://global/skin/icons/check.svg");
    -moz-context-properties: fill, fill-opacity !important;
    fill: currentColor !important;
    color: hsl(0, 0%, 100%) !important;
    background-color: var(--purple-35) !important;
}

popupnotification checkbox:hover .checkbox-check:not(:disabled) {
    background-color: var(--arrowpanel-darker) !important;
}

popupnotification checkbox:hover .checkbox-check[checked]:not(:disabled) {
    background-color: var(--purple-45) !important;
}

.addon-installed-notification-content > checkbox,
popupnotification .popup-notification-body > .popup-notification-checkbox {
    margin-inline-start: 6px !important;
}

popupnotification .popup-notification-checkbox .checkbox-check {
    width: 13px !important;
    height: 13px !important;
    border: 1px solid var(--in-content-box-border-color) !important;
    background-color: var(--arrowpanel-dimmed) !important;
    background-position: center !important;
    background-repeat: no-repeat !important;
}

popupnotification .popup-notification-checkbox .checkbox-check[checked] {
    list-style-image: url("chrome://global/skin/icons/check.svg") !important;
    -moz-context-properties: fill, fill-opacity !important;
    fill: currentColor !important;
    color: hsl(0, 0%, 100%) !important;
    background-color: var(--purple-35) !important;
}

popupnotification .popup-notification-checkbox:hover .checkbox-check:not(:disabled) {
    background-color: var(--arrowpanel-darker) !important;
}

popupnotification .popup-notification-checkbox:hover .checkbox-check[checked]:not(:disabled) {
    background-color: var(--purple-45) !important;
}

.popup-notification-learnmore-link {
    margin-block: 2px !important;
}

.popup-subitem {
    margin-inline-start: 27px !important;
    margin-top: 1px;
}

#addon-webext-permissions-notification {
    padding-top: 5px;
}

/* hides update popups. i use a script for this now, updateNotificationSlayer.uc.js. use that instead, it's MUCH better. */
/* #appMenu-notification-popup {
    display: none !important;
} */

/* popupnotification:is([popupid="update-available"]) {
    display: none !important;
} */

.panel-header > .subviewbutton-back,
.panel-header > .subviewbutton-back > .toolbarbutton-icon {
    -moz-context-properties: fill, fill-opacity !important;
    fill-opacity: 0.6;
}

.panel-header > .subviewbutton-back:hover,
.panel-header > .subviewbutton-back:hover > .toolbarbutton-icon {
    fill-opacity: 0.8;
}

#plugins-notification-icon[extraAttr="inactive"] > .plugin-icon {
    fill: currentColor !important;
}

#plugins-notification-icon[extraAttr="inactive"] > #plugin-icon-badge {
    fill-opacity: 1;
}

#identity-popup-mainView #identity-popup-security-description description {
    font-size: smaller;
    height: 0.5em !important;
    line-height: 0.1em !important;
}

/* connection security popup yellow "parts of this page" warning styling */
.identity-popup-warning-yellow {
    color: var(--warning-color) !important;
    background-color: transparent !important;
    border: none !important;
}

#identity-popup-mainView
    > #identity-popup-security
    > .identity-popup-security-content
    > .identity-popup-security-connection {
    background-position: 2em 40% !important;
    background-size: 18px auto !important;
}

/* url bar popups */
#identity-popup,
#protections-popup,
.popup-notification-panel {
    fill: currentColor;
    -moz-context-properties: fill, fill-opacity, opacity, stroke, stroke-opacity !important;
}

/* #protections-popup {
    margin-left: -17px !important;
} */

#identity-popup[connection^="secure"] .identity-popup-security-connection,
:root[lwt-popup-brighttext] .identity-popup-connection-secure {
    /*   fill: hsl(114, 100%, 37%) !important; */
    fill: var(--secure-color) !important;
    color: var(--secure-color) !important;
}

#protections-popup-mainView-panel-header-section {
    background: radial-gradient(
        circle farthest-side at top right,
        var(--protection-header-gradient-color-1),
        var(--protection-header-gradient-color-2),
        var(--protection-header-gradient-color-3)
    ) !important;
}

#protections-popup-milestones {
    border-radius: 4px !important;
    overflow: hidden !important;
    background: radial-gradient(
        circle farthest-side at top left,
        hsla(318, 73%, 69%, 0.1),
        hsla(265, 100%, 69%, 0.25),
        hsla(217, 90%, 39%, 0.5)
    ) !important;
}

#protections-popup-milestones-content {
    border-radius: 4px !important;
}

#protections-popup-tp-switch:is(:hover, :focus-visible) {
    border: 1px solid hsla(210, 4%, 90%, 0.14) !important;
    background: #003eaa !important;
}

#identity-popup-security-expander > .button-box {
    border: none !important;
}

#protections-popup-not-blocking-section-why {
    border-radius: 0.1% !important;
}

.identity-popup-warning-box {
    border-radius: 4px !important;
    border-color: transparent !important;
}

.identity-popup-section {
    -moz-box-align: center;
}

.identity-popup-expander {
    width: min-content !important;
    padding: 10px !important;
    box-shadow: none !important;
    list-style-image: url(chrome://global/skin/icons/menu-arrow-left.svg) !important;
    background: none !important;
}

.identity-popup-expander:-moz-locale-dir(ltr) {
    transform: scaleX(-1);
}

.identity-popup-expander .button-icon {
    width: 16px !important;
    height: 16px !important;
}

.identity-popup-expander .button-box {
    border-radius: var(--toolbarbutton-border-radius);
    width: 32px;
    height: 32px;
}

.identity-popup-expander:is(:hover, :focus-visible) .button-box {
    background-color: var(--arrowpanel-dimmed);
}

.identity-popup-expander:is(:hover, :focus-visible):active .button-box {
    background-color: var(--arrowpanel-dimmed-further);
}

#identity-popup-multiView .panel-button {
    appearance: none !important;
    color: currentColor !important;
    fill: currentColor !important;
    background-color: var(--arrowpanel-dimmed) !important;
    border-radius: 3px !important;
    padding: 0.15em 0.4em !important;
    align-self: center !important;
}

#identity-popup-multiView .panel-button:not([disabled]):is(:hover:active, [open]) {
    background-color: var(--arrowpanel-dimmed-even-further) !important;
}

#identity-popup-multiView .panel-button:not([disabled]):hover {
    background-color: var(--arrowpanel-dimmed-further) !important;
}

#identity-popup-multiView .panel-button:not([disabled]) {
    background-color: var(--arrowpanel-dimmed) !important;
}

#identity-popup-multiView .panel-button[disabled="true"] {
    opacity: 0.6 !important;
    pointer-events: none !important;
}

#identity-popup-securityView-body {
    display: flex;
    flex-flow: column nowrap;
    gap: 8px;
}

#identity-popup-securityView-body > button {
    width: -moz-available;
}

#identity-popup-securityView-body > :is(description, label, button) {
    margin-block: 0 !important;
}

#identity-popup-securityView-body > description#identity-popup-content-verifier {
    margin-top: 0 !important;
}

#identity-popup-securityView-body > description#identity-popup-content-owner {
    margin-bottom: revert !important;
    padding-inline-start: 8px;
    margin-top: 0 !important;
}

#identity-popup-securityView-body > description#identity-popup-content-supplemental {
    margin-top: revert !important;
    padding-inline-start: 16px;
}

.identity-popup-security-connection description {
    margin-inline-start: 0 !important;
}

.panel-view-body-unscrollable {
    overflow-y: scroll !important;
}

.identity-popup-warning-yellow {
    color: inherit !important;
    background-color: var(--warning-background) !important;
    --lwt-popup-brighttext-url-color: var(--urlbar-popup-action-color);
}

.identity-popup-warning-gray {
    --lwt-popup-brighttext-url-color: var(--urlbar-popup-url-color);
}

#notification-popup menulist {
    color: var(--notification-menu-color) !important;
}

#downloadsPanel-mainView {
    width: unset !important;
}

#downloadsFooterButtons {
    margin: 0 !important;
    border: none !important;
}

#downloadsFooterButtons > button {
    padding-inline: 16px !important;
    padding-block: 10px 11px !important;
    border-radius: 0 !important;
    border-top: 1px solid var(--panel-separator-color) !important;
}

#downloadsFooterButtons > button:hover,
#downloadsPanel[hasdownloads="true"] #downloadsFooterButtons > button:focus-visible {
    background-color: transparent !important;
    background-image: var(--download-button-hover-bg) !important;
}

#downloadsPanel:not([hasdownloads="true"]) #downloadsFooterButtons > button:focus-visible:not(:hover) {
    background-color: transparent !important;
}

#downloadsListBox > .download-state > toolbarseparator {
    visibility: collapse !important;
}

#downloadsListBox > .download-state {
    min-height: 66px !important;
    height: 66px !important;
    -moz-box-align: center !important;
    border: none !important;
}

.downloadsPanelFooterButton:hover {
    outline: none !important;
}

#downloadsHistory {
    margin-top: 0 !important;
}

#downloadsListBox > richlistitem[state="1"][exists] .downloadMainArea:hover,
#downloadsListBox > richlistitem:not([verdict]) > .downloadButton:hover,
#downloadsListBox > richlistitem[verdict]:hover {
    background-color: unset !important;
}

#downloadsListBox > .download-state:is(:hover, :focus-within) {
    background-image: var(--download-button-hover-bg) !important;
}

#downloadsListBox .downloadContainer {
    min-height: 66px !important;
}

#downloadsListBox > .download-state > .downloadButton {
    min-height: 56px !important;
    min-width: 56px !important;
    margin: 5px !important;
    border-radius: 100% !important;
    -moz-box-align: center !important;
    background: none !important;
    -moz-box-pack: center !important;
}

#downloadsListBox > .download-state > .downloadButton:is(:hover, :focus-visible) .button-box {
    background: var(--arrowpanel-dimmed) !important;
}

#downloadsListBox
    > .download-state
    > .downloadButton:is(:hover, :focus-visible):active
    .button-box {
    background: var(--arrowpanel-dimmed-further) !important;
}

#downloadsListBox > .download-state > .downloadButton .button-box {
    min-width: 35.5px !important;
    max-width: 35.5px !important;
    min-height: 35.5px !important;
    max-height: 35.5px !important;
    border-radius: 100% !important;
}

#downloadsListBox > .download-state > .downloadButton .button-box .button-icon {
    width: 22px !important;
    height: auto !important;
    list-style-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32'><path fill='context-fill' fill-opacity='context-fill-opacity' d='M17.3 9.4h10.4v-.2c0-1.5-.9-2.6-2-2.6h-5.8v-.3c0-.6-1.5-2-2.8-2H4.9v7h8.5c3 0 3.9-1.9 3.9-1.9zM29 13c0-.6-.6-1.1-1.5-1.7h-9s-1.5 2.4-3.7 2.4H5.4C3 13.7 3 15.9 3 15.9l1.1 9.7c0 1.5.9 2.4 2.4 2.4h19.1c1.5 0 2.4-.9 2.4-2.4l1-11.9V13z'/></svg>") !important;
}

/* grid overflow menu (i don't have an overflow menu at all thanks to the toolbar button slider script. but just in case) */
/* :root:not([customizing]) #widget-overflow-mainView {
    min-width: 370px !important;
}

:root:not([customizing]) #widget-overflow-mainView>.panel-subview-body {
    padding: 4px !important;
}

:root:not([customizing]) .widget-overflow-list {
    display: grid;
    grid-template-areas: "a a a a a a a a a a a a";
    grid-auto-columns: auto;
}

:root:not([customizing]) #widget-overflow-mainView[visible] .widget-overflow-list {
    max-width: 370px
}

:root:not([customizing]) #widget-overflow-mainView~panelview[visible] {
    max-width: unset !important;
}

:root:not([customizing]) .widget-overflow-list>* {
    padding-block: 8px !important;
}

:root:not([customizing]) .widget-overflow-list>#search-container {
    grid-area: s
}

:root:not([customizing]) .widget-overflow-list .subviewbutton-nav::after,
:root:not([customizing]) .widget-overflow-list .toolbarbutton-text {
    display: none
}

:root:not([customizing]) .widget-overflow-list .toolbarbutton-1 {
    -moz-appearance: none !important;
    margin: 2px !important;
    padding: 0 !important;
    -moz-box-pack: center !important;
    display: -moz-box !important;
    border-radius: var(--toolbarbutton-border-radius) !important;
    width: 28px !important;
    height: 28px !important;
}

:root:not([customizing]) .widget-overflow-list .toolbarbutton-1 .toolbarbutton-icon {
    padding: 6px !important;
    width: calc(2 * var(--toolbarbutton-inner-padding) + 16px) !important;
    height: calc(2 * var(--toolbarbutton-inner-padding) + 16px) !important;
}

:root:not([customizing]) .widget-overflow-list {
    width: 370px !important;
}

:root:not([customizing]) #widget-overflow-mainView .panel-subview-body {
    width: 370px !important;
}

:root:not([customizing]) #widget-overflow-mainView {
    min-width: 370px !important;
    max-width: 370px !important;
}

:root:not([customizing]) #widget-overflow {
    width: 370px !important;
}

.widget-overflow-arrowbox[pack="end"] {
    margin-right: 4.4px !important;
}

#widget-overflow-list .toolbarbutton-menu-dropmarker {
    display: none !important;
}

#widget-overflow {
    margin-right: -24.4px !important;
}

#widget-overflow .toolbarbutton-badge {
    margin: 0 !important;
    margin-inline-end: 0px !important;
} */

/* specific widget menus */
#PanelUI-webext-_63d150c4-394c-4275-bc32-c464e76a891c_-browser-action-view {
    min-width: 550px !important;
}

#PanelUI-webext-_bee8b1f2-823a-424c-959c-f8f76c8b2306_-browser-action-view {
    min-width: 200px !important;
    width: 230px !important;
}

#PanelUI-webext-multithreaded-download-manager_qw_linux-2g64_local-browser-action-view
    .webextension-popup-browser {
    min-height: 230px !important;
}

#PanelUI-webext-_a6c4a591-f1b2-4f03-b3ff-767e5bedf4e7_-browser-action-view {
    min-width: 700px !important;
}

/* all tabs menu panel */
#customizationui-widget-panel[viewId="allTabsMenu-allTabsView"] .panel-viewcontainer[panelopen] {
    min-height: auto !important;
}

#allTabsMenu-containerTabsView {
    padding-block-end: 4px !important;
}

/* urlbar page action menu */
#pageActionPanel panelview {
    min-width: 18em !important;
}

#pageAction-panel-builtInSeparator {
    display: none;
}

@supports -moz-bool-pref("browser.proton.contextmenus.enabled") {
    .menu-right {
        margin-inline-end: 0 !important;
    }

    /* ugly small menu separators */
    #widget-overflow-mainView > toolbarseparator,
    #widget-overflow-mainView > .panel-subview-body > toolbarseparator,
    .PanelUI-subView toolbarseparator,
    .cui-widget-panelview menuseparator,
    .cui-widget-panel toolbarseparator {
        margin-inline: 4px !important;
    }

    .panel-footer.panel-footer-menulike {
        margin-inline: 4px !important;
        margin-block: 0 4px !important;
    }

    #identity-popup-securityView-body {
        padding-block: 0.5em;
    }

    #identity-popup-securityView .identity-popup-security-content,
    .identity-popup-section,
    .permission-popup-section,
    .protections-popup-section {
        margin-inline: 4px;
    }
}
